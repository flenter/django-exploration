box: wercker/python
services:
  - mies/postgis@0.0.5
# Build definition
build:
  # The steps that will be executed on build
  steps:

    - script:
        name: Check environment variables...
        code: |
          export WERCKER_POSTGRESQL_URL="postgis://postgres:wercker@$WERCKER_POSTGRESQL_HOST:5432/werckerdb1"
          python --version
          which pip
          which python
          ls -la /usr/local/bin
          cat `which pip`
          python --version
          sudo which pip
          sudo pip install wercker
          python test.py


    - install-packages:
        packages: postgresql-9.3-postgis

    - virtualenv:
        python_location: /usr/bin/python3.2

    - pip-install
    - script:
        name: run django tests
        code: |
          python manage.py test
